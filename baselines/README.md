# Baselines

Comparison experiments against baseline methods.

## Overview

| Method | Language | Inference | Status |
|---|---|---|---|
| MAGI | R (CRAN `magi` v1.2.5) | HMC | Adopted |

## Setup

### 1. Data generation (Julia)

All methods share common observation data. Generate data from the Julia side first:

```bash
julia --project=. experiments/generate_data.jl
```

CSV files are output to `baselines/data/` in the following format:
- `lv_N{N}_seed{seed}.csv` — Noisy observations
- `lv_N{N}_seed{seed}_clean.csv` — True trajectories (for reference)

### 2. MAGI (R)

```bash
# Install R packages and verify ODE model definitions
Rscript baselines/magi/setup.R

# Run experiments for each ODE system
Rscript baselines/magi/run_lv.R           # Lotka-Volterra
Rscript baselines/magi/run_fn.R           # FitzHugh-Nagumo
Rscript baselines/magi/run_pst.R          # Protein Signaling Transduction
Rscript baselines/magi/run_magi_lvcomp.R  # LV Competition (K variable)
Rscript baselines/magi/run_magi_lynxhare.R  # Lynx-Hare real data (Exp8)

# Run a specific condition
Rscript baselines/magi/run_lv.R --N 40 --seed 42 --niter 20000
Rscript baselines/magi/run_magi_lvcomp.R --K 2 --seed 42 --N 40

# Generate trajectory CSV for experiment visualisation
Rscript baselines/magi/run_lv.R --N 25 --seed 42 --trajectory
Rscript baselines/magi/run_magi_lynxhare.R --seed 42 --trajectory
```

Results are saved to `baselines/magi/results/`:
- `{ode}_summary.csv` — RMSD, ESS, and wall-clock time for each seed and N
- `{ode}_N{N}_seed{seed}_samples.csv` — Posterior samples of theta
- `magi_lv_trajectory.csv` — Posterior trajectory (with `--trajectory` flag)
- `magi_lynxhare_*.csv` — Lynx-Hare results and trajectory

### 3. Aggregate results

```bash
julia --project=. baselines/compare.jl
```

Aggregates results from all methods into `baselines/results_comparison.csv`.

## Directory structure

```
baselines/
├── README.md              # This file
├── data/                  # Shared observation data (generated by generate_data.jl)
├── magi/
│   ├── setup.R            # R environment setup and model verification
│   ├── models.R           # ODE model definitions (matching Julia implementations)
│   ├── run_lv.R           # Lotka-Volterra (--trajectory flag for Exp6)
│   ├── run_fn.R           # FitzHugh-Nagumo experiment
│   ├── run_pst.R          # Protein Signaling Transduction experiment
│   ├── run_magi_lvcomp.R  # LV Competition experiment (K variable)
│   ├── run_magi_lynxhare.R  # Lynx-Hare real data (Exp8, --trajectory flag)
│   └── results/           # MAGI output
└── compare.jl             # Results aggregation script
```

## MCMC settings (defaults)

| Parameter | MAGI | RFFGM/GPGM |
|---|---|---|
| Iterations | 20,000 | 10,000 |
| Burn-in | 50% (10,000) | 50% (5,000) |
| Leapfrog steps | 200 | NUTS (automatic) |
| Seeds | 42, 123, 456, 789, 1234 | Same |

## ODE model mapping

| ODE | MAGI implementation | Notes |
|---|---|---|
| LV | `lvmodel` in `models.R` (custom) | Not built into MAGI. `--trajectory` for Exp6 |
| FN | `fnmodel_jl` in `models.R` (custom) | Sign convention differs from MAGI built-in |
| PST | `ptransmodelODE` (MAGI built-in) | Matches Julia implementation |
| LVC | `make_lvc_model()` in `models.R` (custom) | Off-diagonal α only, K variable |
| Lynx-Hare | `lvmodel` in `models.R` (reused) | Real data, `run_magi_lynxhare.R` |
